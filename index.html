<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PlanProMax</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="app" v-cloak class="h-screen flex flex-col md:flex-row overflow-hidden text-slate-800 bg-[#f1f5f9]">

    <!-- === ÁôªÂΩïÂ±Ç (Ê†∑ÂºèÂæÆË∞ÉÈÄÇÈÖçÊâãÊú∫) === -->
    <div v-if="!accessKey" class="fixed inset-0 z-[60] flex items-center justify-center bg-slate-100/80 backdrop-blur-sm p-6">
        <div class="bg-white p-6 rounded-2xl shadow-2xl w-full max-w-sm border border-white">
            <div class="text-center mb-6">
                <div class="w-14 h-14 bg-blue-600 rounded-2xl flex items-center justify-center text-white mx-auto shadow-lg mb-3 text-2xl">
                    <i class="ph-bold ph-check-square-offset"></i>
                </div>
                <h1 class="text-xl font-black text-slate-800">PlanPro Cloud</h1>
                <p class="text-xs text-slate-500 mt-1">Êï∞ÊçÆÈöèË∫´Â∏¶ÔºåÂçè‰ΩúÊó†ÈöúÁ¢ç</p>
            </div>
            <div class="space-y-3">
                <input type="text" v-model="inputKey" @keyup.enter="login" placeholder="ËæìÂÖ• Key..." class="w-full border-2 border-slate-100 rounded-xl px-4 py-3 focus:outline-none focus:border-blue-500 focus:ring-4 focus:ring-blue-50 font-mono text-center font-bold text-lg text-slate-700 bg-slate-50">
                <button @click="login" class="w-full bg-blue-600 text-white font-bold py-3 rounded-xl hover:bg-blue-700 shadow-lg shadow-blue-200 active:scale-95">ËøõÂÖ•</button>
                <button @click="generateKey" class="text-xs text-blue-500 font-bold block w-full py-2">Ê≤°ÊúâKeyÔºüÈöèÊú∫ÁîüÊàê</button>
            </div>
        </div>
    </div>

    <!-- === ‰∏ªÁïåÈù¢ === -->
    <template v-if="accessKey">
        
        <!-- üíª ÁîµËÑëÁ´Ø‰æßËæπÊ†è (ÊâãÊú∫ÈöêËóè) -->
        <aside class="hidden md:flex w-64 bg-white border-r border-slate-200 flex-col z-20 shadow-lg shrink-0">
            <div class="p-6 flex items-center gap-3 border-b border-slate-100 h-16">
                <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white shadow-md">
                    <i class="ph ph-check-square-offset text-xl"></i>
                </div>
                <div class="flex-1 min-w-0">
                    <h1 class="text-lg font-bold text-slate-800 leading-tight">PlanPro_ZY</h1>
                    <div class="text-[10px] text-slate-400 font-mono truncate">üîë {{ accessKey }}</div>
                </div>
            </div>
            <!-- ÂêåÊ≠•Áä∂ÊÄÅ -->
            <div class="px-6 py-2">
                <div class="flex items-center gap-2 text-xs px-3 py-1.5 rounded-lg border transition-colors" :class="syncStatus.class">
                    <i :class="syncStatus.icon"></i><span class="font-bold">{{ syncStatus.text }}</span>
                </div>
            </div>
            <!-- ÁîµËÑëÂØºËà™ -->
            <nav class="flex-1 p-4 space-y-2">
                <button @click="switchView('dashboard')" class="nav-btn" :class="currentView === 'dashboard' ? 'active-blue' : 'inactive'"><i class="ph ph-sun text-lg"></i> ‰ªäÊó•ÁúãÊùø <span v-if="activeTasks.length > 0" class="ml-auto bg-blue-600 text-white text-[10px] px-2 py-0.5 rounded-full">{{ activeTasks.length }}</span></button>
                <button @click="switchView('templates')" class="nav-btn" :class="currentView === 'templates' ? 'active-purple' : 'inactive'"><i class="ph ph-copy text-lg"></i> ‰ªªÂä°Ê®°Êùø</button>
                <button @click="switchView('scheduled')" class="nav-btn" :class="currentView === 'scheduled' ? 'active-teal' : 'inactive'"><i class="ph ph-clock-countdown text-lg"></i> ÂÆöÊó∂‰ªªÂä°</button>
                <button @click="switchView('statistics')" class="nav-btn" :class="currentView === 'statistics' ? 'active-indigo' : 'inactive'"><i class="ph ph-chart-bar text-lg"></i> Êï∞ÊçÆÁªüËÆ°</button>
            </nav>
            <!-- Â∫ïÈÉ®Êìç‰ΩúÂå∫ -->
            <div class="p-4 border-t border-slate-100 bg-slate-50">
                <div class="grid grid-cols-4 gap-2">
                    <button @click="exportData" class="action-btn hover:text-blue-600"><i class="ph ph-download-simple"></i></button>
                    <button @click="$refs.fileInput.click()" class="action-btn hover:text-blue-600"><i class="ph ph-upload-simple"></i></button>
                    <button @click="logout" class="action-btn col-span-2 text-red-500 font-bold border-red-100">ÂàáÊç¢</button>
                    <button @click="handleClearData" class="action-btn col-span-4 text-[10px] text-red-400">Âà†Â∫ì</button>
                    <input type="file" ref="fileInput" @change="importData" class="hidden" accept=".json">
                </div>
            </div>
        </aside>

        <!-- üì± ÊâãÊú∫Á´ØÂ∫ïÈÉ®ÂØºËà™Ê†è (ÁîµËÑëÈöêËóè) -->
        <nav class="md:hidden mobile-nav-bar">
            <button @click="switchView('dashboard')" class="mobile-nav-item" :class="currentView === 'dashboard' ? 'active' : ''">
                <i class="ph-bold" :class="currentView === 'dashboard' ? 'ph-sun' : 'ph-sun-dim'"></i>
                <span>ÁúãÊùø</span>
            </button>
            <button @click="switchView('templates')" class="mobile-nav-item" :class="currentView === 'templates' ? 'active' : ''">
                <i class="ph-bold" :class="currentView === 'templates' ? 'ph-copy' : 'ph-copy-simple'"></i>
                <span>Ê®°Êùø</span>
            </button>
            <!-- ‰∏≠Èó¥ÁöÑÂ§ßÂä†Âè∑ÊåâÈíÆ -->
            <button @click="openModal()" class="mobile-nav-item">
                <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white shadow-lg active:scale-90 transition">
                    <i class="ph-bold ph-plus text-xl mb-0"></i>
                </div>
            </button>
            <button @click="switchView('scheduled')" class="mobile-nav-item" :class="currentView === 'scheduled' ? 'active' : ''">
                <i class="ph-bold" :class="currentView === 'scheduled' ? 'ph-clock-countdown' : 'ph-clock'"></i>
                <span>ÂÆöÊó∂</span>
            </button>
            <button @click="switchView('statistics')" class="mobile-nav-item" :class="currentView === 'statistics' ? 'active' : ''">
                <i class="ph-bold" :class="currentView === 'statistics' ? 'ph-chart-bar' : 'ph-chart-bar-horizontal'"></i>
                <span>ÁªüËÆ°</span>
            </button>
        </nav>

        <!-- ‰∏ªÂÜÖÂÆπÂå∫ -->
        <main class="flex-1 flex flex-col relative min-w-0 pb-[3.5rem] md:pb-0">
            
            <!-- ÊâãÊú∫Á´ØÈ°∂ÈÉ®ÔºöÂè™ÊòæÁ§∫Ê†áÈ¢òÂíåÂêåÊ≠•Áä∂ÊÄÅ -->
            <div class="md:hidden h-12 bg-white flex items-center justify-between px-4 border-b border-slate-100 shrink-0 sticky top-0 z-10">
                <div class="font-bold text-slate-700 flex items-center gap-2">
                    PlanPro <span class="text-[10px] bg-slate-100 px-1 rounded text-slate-400 font-mono">{{ accessKey ? accessKey.slice(-4) : '' }}</span>
                </div>
                <!-- ÊâãÊú∫Á´ØÁöÑÂ∞èÂêåÊ≠•ÂõæÊ†á -->
                <div class="text-xs flex items-center gap-1" :class="syncStatus.text === 'ÂêåÊ≠•Â§±Ë¥•' ? 'text-red-500' : 'text-slate-400'">
                    <i v-if="isSyncing === 'syncing'" class="ph-bold ph-spinner animate-spin text-blue-500"></i>
                    <i v-else-if="isSyncing === 'done'" class="ph-bold ph-check text-green-500"></i>
                    <i v-else-if="isSyncing === 'error'" class="ph-bold ph-warning"></i>
                    <i v-else class="ph-bold ph-cloud-check"></i>
                </div>
                <!-- ÊâãÊú∫Á´ØËÆæÁΩÆËèúÂçïÂÖ•Âè£ -->
                <button @click="logout" class="text-slate-400"><i class="ph-bold ph-sign-out"></i></button>
            </div>

            <!-- ÂÜÖÂÆπÊªöÂä®Âå∫ -->
            <div class="flex-1 overflow-y-auto p-3 md:p-4 space-y-3 scroll-smooth">
                
                <!-- ËßÜÂõæA: ÁúãÊùø -->
                <template v-if="currentView === 'dashboard'">
                    <!-- Êó•ÊúüÊéßÂà∂Âô® (ÈÄÇÈÖçÊâãÊú∫) -->
                    <div class="bg-white rounded-xl p-2 shadow-sm border border-slate-100 flex items-center justify-between mb-2 sticky top-0 z-0 md:relative">
                        <button @click="changeDate(-1)" class="w-10 h-10 flex items-center justify-center text-slate-500 hover:bg-slate-50 rounded-lg"><i class="ph-bold ph-caret-left text-lg"></i></button>
                        <div class="flex flex-col items-center">
                            <div class="text-sm font-bold text-slate-800 flex items-center gap-1 relative">
                                {{ dateInfo.date }} <i class="ph-fill ph-caret-down text-xs text-slate-300"></i>
                                <input type="date" v-model="viewDate" class="absolute inset-0 opacity-0 z-10">
                            </div>
                            <div class="text-[10px] text-slate-400 font-bold uppercase tracking-wider">{{ dateInfo.week }}</div>
                        </div>
                        <button @click="changeDate(1)" class="w-10 h-10 flex items-center justify-center text-slate-500 hover:bg-slate-50 rounded-lg"><i class="ph-bold ph-caret-right text-lg"></i></button>
                    </div>

                    <!-- ÂæÖÁîüÊàêÈ¢ÑËßà -->
                    <div v-if="futurePreviews.length > 0" class="mb-4">
                        <div class="flex items-center gap-2 mb-2 px-1">
                            <i class="ph-fill ph-sparkle text-teal-500"></i>
                            <span class="text-xs font-bold text-slate-400">ÂæÖËá™Âä®ÁîüÊàê</span>
                        </div>
                        <div v-for="task in futurePreviews" :key="task.id" class="bg-slate-50 border border-dashed border-slate-300 rounded-xl p-3 flex items-center gap-3 opacity-70">
                            <div class="w-1 h-8 bg-slate-300 rounded-full"></div>
                            <div class="flex-1 text-sm font-bold text-slate-500">{{ task.title }}</div>
                        </div>
                    </div>

                    <!-- Á©∫Áä∂ÊÄÅ -->
                    <div v-if="activeTasks.length === 0 && completedTasks.length === 0 && futurePreviews.length === 0" class="flex flex-col items-center justify-center h-64 text-slate-300">
                        <i class="ph-duotone ph-coffee text-5xl mb-2"></i>
                        <p class="text-xs font-medium">‰∫´ÂèóÂΩì‰∏ãÔºåÊöÇÊó†ÂÆâÊéí</p>
                        <button v-if="viewDate !== today" @click="resetToToday" class="mt-4 px-4 py-2 bg-white border border-slate-200 rounded-full text-xs font-bold text-blue-600 shadow-sm">ÂõûÂà∞‰ªäÂ§©</button>
                    </div>

                    <!-- ‰ªªÂä°ÂàóË°® -->
                    <div v-for="task in activeTasks" :key="task.id" @click="selectTask(task); openModal(task)" class="bg-white rounded-xl shadow-sm border border-slate-200 relative overflow-hidden group active:scale-[0.98] transition-transform duration-100">
                        <div v-if="isOverdue(task)" class="absolute left-0 top-0 bottom-0 w-1 bg-red-500"></div>
                        <div v-else-if="isDueToday(task)" class="absolute left-0 top-0 bottom-0 w-1 bg-orange-400"></div>
                        <div v-else class="absolute left-0 top-0 bottom-0 w-1 bg-slate-200"></div> <!-- ÈªòËÆ§Â∑¶‰æßÊù° -->

                        <div class="p-3 pl-4 flex items-center gap-3">
                            <!-- Áä∂ÊÄÅÂãæÈÄâ -->
                            <div @click.stop class="shrink-0">
                                <select v-model="task.status" @change="updateStatus(task)" class="appearance-none w-5 h-5 rounded-full border-2 cursor-pointer bg-transparent text-transparent focus:outline-none transition-colors"
                                    :class="{'border-slate-300': task.status==='todo', 'border-blue-500 border-t-transparent animate-spin': task.status==='doing', 'bg-green-500 border-green-500': task.status==='done'}">
                                    <option value="todo">todo</option><option value="doing">doing</option><option value="done">done</option>
                                </select>
                            </div>

                            <div class="flex-1 min-w-0">
                                <div class="flex items-center gap-2">
                                    <span class="font-bold text-sm text-slate-800 truncate" :class="{'line-through text-slate-400': task.status==='done'}">{{ task.title }}</span>
                                    <span v-if="task.priority==='urgent'" class="w-2 h-2 rounded-full bg-orange-500 shrink-0"></span>
                                    <span v-if="task.priority==='critical'" class="w-2 h-2 rounded-full bg-red-500 shrink-0"></span>
                                </div>
                                <div class="flex items-center gap-2 mt-0.5">
                                    <span v-if="task.date.includes('T')" class="text-[10px] font-mono text-slate-400 bg-slate-50 px-1 rounded">{{ formatTimeOnly(task.date) }}</span>
                                    <span v-if="task.note" class="text-[10px] text-slate-400 truncate max-w-[10rem]">{{ getLatestNoteLine(task.note) }}</span>
                                </div>
                            </div>

                            <!-- Â±ïÂºÄÂ≠ê‰ªªÂä°ÊåâÈíÆ -->
                            <button @click.stop="task.expanded = !task.expanded" class="w-8 h-8 flex items-center justify-center text-slate-400" v-if="task.subtasks && task.subtasks.length > 0">
                                <i class="ph-bold ph-caret-down transition-transform duration-200" :class="{'rotate-180': task.expanded}"></i>
                            </button>
                        </div>

                        <!-- Â≠ê‰ªªÂä°Âå∫Âüü -->
                        <div v-if="task.expanded" class="bg-slate-50 border-t border-slate-100 px-4 py-2 space-y-2">
                            <div v-for="(sub, idx) in task.subtasks" :key="idx" class="flex items-center gap-2">
                                <i class="ph-fill ph-check-circle text-green-500 text-xs" v-if="sub.status==='done'"></i>
                                <i class="ph ph-circle text-slate-300 text-xs" v-else></i>
                                <span class="text-xs text-slate-600" :class="{'line-through text-slate-400': sub.status==='done'}">{{ sub.title }}</span>
                            </div>
                        </div>
                    </div>

                    <!-- Â∑≤ÂÆåÊàê -->
                    <div v-if="completedTasks.length > 0" class="pt-6">
                        <h3 class="text-xs font-bold text-slate-400 uppercase mb-2">Â∑≤ÂÆåÊàê</h3>
                        <div class="space-y-2 opacity-60 grayscale">
                            <div v-for="task in completedTasks" :key="task.id" class="bg-slate-50 rounded-lg p-3 flex items-center gap-3 border border-slate-100">
                                <i class="ph-fill ph-check-circle text-slate-400 text-lg"></i>
                                <span class="text-sm line-through text-slate-500">{{ task.title }}</span>
                            </div>
                        </div>
                    </div>
                </template>

                <!-- ËßÜÂõæB: Ê®°Êùø (ÊâãÊú∫ÈÄÇÈÖç) -->
                <template v-if="currentView === 'templates'">
                    <div class="grid grid-cols-2 gap-3">
                        <div v-for="tmpl in templates" :key="tmpl.id" @click="openModal(tmpl)" class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 active:scale-95 transition">
                            <div class="w-8 h-8 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center mb-2"><i class="ph-bold ph-magic-wand"></i></div>
                            <div class="font-bold text-sm text-slate-700 truncate">{{ tmpl.title }}</div>
                            <div class="text-[10px] text-slate-400 mt-1">{{ tmpl.subtasks.length }} ‰∏™Ê≠•È™§</div>
                        </div>
                        <div @click="openModal()" class="bg-slate-50 border-2 border-dashed border-slate-200 rounded-xl flex flex-col items-center justify-center text-slate-400 gap-1 min-h-[100px]">
                            <i class="ph-bold ph-plus text-2xl"></i>
                            <span class="text-xs font-bold">Êñ∞Âª∫</span>
                        </div>
                    </div>
                </template>

                <!-- ËßÜÂõæD: ÁªüËÆ° (ÊâãÊú∫ÈÄÇÈÖç) -->
                <template v-if="currentView === 'statistics'">
                    <div class="grid grid-cols-2 gap-3 mb-4">
                        <div class="bg-white p-3 rounded-xl shadow-sm border border-slate-100">
                            <div class="text-[10px] text-slate-400 uppercase font-bold">Êú¨Âë®ÂÆåÊàê</div>
                            <div class="text-2xl font-black text-green-500">{{ statsData.done }}</div>
                        </div>
                        <div class="bg-white p-3 rounded-xl shadow-sm border border-slate-100">
                            <div class="text-[10px] text-slate-400 uppercase font-bold">ÂæÖÂäû‰ªªÂä°</div>
                            <div class="text-2xl font-black text-slate-700">{{ statsData.todo }}</div>
                        </div>
                    </div>
                    <!-- ÁÆÄÂçïÁöÑÂàóË°®‰ª£ÊõøË°®Ê†º -->
                    <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                        <div class="px-4 py-3 border-b border-slate-100 font-bold text-sm text-slate-700">ÊúÄËøëÂä®ÊÄÅ</div>
                        <div class="divide-y divide-slate-100">
                            <div v-for="t in statsData.list.slice(0, 10)" :key="t.id" class="px-4 py-3 flex items-center justify-between">
                                <div class="truncate mr-2">
                                    <div class="text-sm font-bold text-slate-700 truncate">{{ t.title }}</div>
                                    <div class="text-[10px] text-slate-400">{{ formatDateTime(t.date) }}</div>
                                </div>
                                <span class="text-[10px] font-bold px-2 py-1 rounded bg-slate-100 text-slate-500" :class="getStatsStatusStyle(t)">{{ getStatsStatusLabel(t) }}</span>
                            </div>
                        </div>
                    </div>
                </template>

            </div>
        </main>

        <!-- üíª ÁîµËÑëÁ´ØÂè≥‰æßËØ¶ÊÉÖ (ÊâãÊú∫Á´Ø‰ΩøÁî® hidden-on-mobile ÈöêËóè) -->
        <aside class="hidden-on-mobile hidden md:flex w-[350px] bg-white border-l border-slate-200 flex-col z-10 shrink-0 h-full shadow-[-4px_0_15px_rgba(0,0,0,0.02)]">
            <div class="h-16 border-b border-slate-100 flex items-center px-6 bg-slate-50/80">
                <h3 class="font-bold text-slate-700 flex items-center gap-2"><i class="ph ph-sliders-horizontal"></i> ‰ªªÂä°ËØ¶ÊÉÖ</h3>
            </div>
            <div v-if="activeTask" class="flex-1 overflow-y-auto p-6 flex flex-col h-full">
                <!-- ÁîµËÑëÁ´ØÂéüÊúâÁöÑËØ¶ÊÉÖÂÜÖÂÆπ -->
                <div class="mb-6"><h2 class="text-2xl font-black text-slate-800 leading-snug">{{ activeTask.title }}</h2></div>
                <textarea v-model="activeTask.note" class="flex-1 w-full bg-yellow-50 border border-yellow-200 rounded-xl p-4 text-sm text-slate-700 resize-none font-mono"></textarea>
            </div>
            <div v-else class="h-full flex flex-col items-center justify-center text-center opacity-40 p-10"><i class="ph ph-hand-tap text-5xl text-slate-300 mb-4 animate-bounce"></i><h4 class="font-bold text-slate-600 text-lg">ÁÇπÂáªÂàóË°®È°π</h4></div>
        </aside>

        <!-- Ê®°ÊÄÅÊ°Ü (ÈÄÇÈÖçÊâãÊú∫ÂÖ®Â±è/Â∫ïÈÉ®ÂºπÂá∫) -->
        <div v-if="modal.show" class="fixed inset-0 z-[100] flex items-center justify-center p-4 sm:p-0">
            <div @click="modal.show = false" class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity"></div>
            <!-- Ê∑ªÂä† modal-container Á±ª‰ª•Â∫îÁî®ÊâãÊú∫Á´ØÂ∫ïÈÉ®ÊªëÂá∫Âä®Áîª -->
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-lg relative flex flex-col max-h-[90vh] overflow-hidden modal-container">
                <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50 shrink-0">
                    <h3 class="font-bold text-lg text-slate-800">{{ modal.isEdit ? 'ÁºñËæë' : 'Êñ∞Âª∫' }}{{ getViewName() }}</h3>
                    <button @click="modal.show = false" class="w-8 h-8 rounded-full bg-slate-200 flex items-center justify-center text-slate-500"><i class="ph-bold ph-x"></i></button>
                </div>
                <div class="p-6 overflow-y-auto space-y-5">
                    <div><label class="text-xs font-bold text-slate-400 uppercase">‰ªªÂä°ÂêçÁß∞</label><input v-model="modal.data.title" type="text" class="w-full text-xl font-black border-b-2 border-slate-200 py-1 focus:border-blue-500 outline-none bg-transparent" placeholder="Ë¶ÅÂÅö‰ªÄ‰πàÔºü"></div>
                    
                    <div class="bg-slate-50 p-4 rounded-xl border border-slate-100">
                        <label class="text-xs font-bold text-slate-400 uppercase mb-2 block">Â≠êÊ≠•È™§</label>
                        <div class="space-y-2">
                            <div v-for="(sub, index) in modal.data.subtasks" :key="sub._key || index" class="flex gap-2 items-center">
                                <input v-model="sub.title" class="flex-1 bg-white border border-slate-200 rounded px-2 py-2 text-sm focus:border-blue-500 outline-none">
                                <button @click="modal.data.subtasks.splice(index, 1)" class="text-red-400 p-2"><i class="ph-bold ph-trash"></i></button>
                            </div>
                            <div class="flex gap-2">
                                <input type="text" ref="newSubInput" placeholder="Ê∑ªÂä†Ê≠•È™§..." @keydown.enter="addModalSubtask" class="flex-1 bg-transparent border-b border-slate-300 focus:border-blue-500 px-2 py-1 text-sm outline-none">
                                <button @click="addModalSubtask" class="text-blue-600 font-bold text-sm">Ê∑ªÂä†</button>
                            </div>
                        </div>
                    </div>

                    <div v-if="currentView === 'dashboard'" class="grid grid-cols-2 gap-4">
                        <div><label class="text-xs font-bold text-slate-400 uppercase">ËÆ°ÂàíÊó∂Èó¥</label><input type="datetime-local" v-model="modal.data.date" class="w-full bg-slate-50 border border-slate-200 rounded-lg px-2 py-2 text-sm"></div>
                        <div><label class="text-xs font-bold text-slate-400 uppercase">Êà™Ê≠¢Êó∂Èó¥</label><input type="datetime-local" v-model="modal.data.deadline" class="w-full bg-slate-50 border border-slate-200 rounded-lg px-2 py-2 text-sm"></div>
                    </div>
                    
                    <div><label class="text-xs font-bold text-slate-400 uppercase mb-1 block">‰ºòÂÖàÁ∫ß</label><div class="flex gap-2"><button v-for="p in ['normal','urgent','critical']" :key="p" @click="modal.data.priority = p" class="flex-1 py-2 rounded-lg text-xs font-bold border transition-all" :class="modal.data.priority === p ? 'bg-slate-800 text-white border-slate-800' : 'bg-white text-slate-500 border-slate-200'">{{ {normal:'ÊôÆÈÄö', urgent:'Á¥ßÊÄ•', critical:'ÁâπÊÄ•'}[p] }}</button></div></div>
                    
                    <div><label class="text-xs font-bold text-slate-400 uppercase">Â§áÊ≥®</label><textarea v-model="modal.data.note" rows="3" class="w-full bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-sm resize-none"></textarea></div>
                </div>
                <div class="p-4 border-t border-slate-100 flex gap-3 bg-white shrink-0 pb-8 md:pb-4">
                    <button @click="modal.show = false" class="flex-1 py-3 text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-xl font-bold">ÂèñÊ∂à</button>
                    <button @click="saveTask" class="flex-1 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 font-bold shadow-lg shadow-blue-200">‰øùÂ≠ò</button>
                </div>
            </div>
        </div>

    </template>

</div>

<script src="script.js"></script>
</body>
</html>
